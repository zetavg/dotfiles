#!/usr/bin/env bash
# Launches OpenAI Codex CLI installed under the global Node.js.
# CODEX_OPENAI_API_KEY and CODEX_OPENAI_BASE_URL, if set, overrides the standard OpenAI API setup.

set -euo pipefail

[ -n "${CODEX_OPENAI_API_KEY:-}" ] && export OPENAI_API_KEY="$CODEX_OPENAI_API_KEY"
[ -n "${CODEX_OPENAI_BASE_URL:-}" ] && export OPENAI_BASE_URL="$CODEX_OPENAI_BASE_URL"

SCRIPT_PATH="${BASH_SOURCE[0]:-$0}"
SCRIPT_DIR="$(cd "$(dirname "$SCRIPT_PATH")" && pwd)"

source "${SCRIPT_DIR}/utils/find_global_command_path.sh"
codex_path=$(find_global_command_path "node" "codex" "npm install -g @openai/codex" "$SCRIPT_PATH")

exec "$codex_path" "$@"
